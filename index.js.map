{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '49395214-508d98637227ed6d41be849b6';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function fetchImages(searchQuery, page = 1, perPage = 15) {\n  try {\n    const response = await axios.get(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q: searchQuery,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page: page,\n        per_page: perPage,\n      },\n    });\n    return response.data;\n  } catch (error) {\n    throw new Error(`Failed to fetch images: ${error.message}`);\n  }\n}\n","export function renderGallery(images, galleryElement) {\n  const markup = images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n      <div class=\"photo-card\">\n        <a href=\"${largeImageURL}\">\n          <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n        </a>\n        <div class=\"info\">\n          <p class=\"info-item\">\n            <b>Likes</b>\n            ${likes}\n          </p>\n          <p class=\"info-item\">\n            <b>Views</b>\n            ${views}\n          </p>\n          <p class=\"info-item\">\n            <b>Comments</b>\n            ${comments}\n          </p>\n          <p class=\"info-item\">\n            <b>Downloads</b>\n            ${downloads}\n          </p>\n        </div>\n      </div>\n    `\n    )\n    .join('');\n\n  galleryElement.insertAdjacentHTML('beforeend', markup);\n}\n\nexport function clearGallery(galleryElement) {\n  galleryElement.innerHTML = '';\n}\n\nexport function showElement(element) {\n  element.classList.remove('is-hidden');\n}\n\nexport function hideElement(element) {\n  element.classList.add('is-hidden');\n}\n\nexport function showLoadingIndicator(element) {\n  element.classList.remove('is-hidden');\n}\n\nexport function hideLoadingIndicator(element) {\n  element.classList.add('is-hidden');\n}\n\nexport function showEndMessage(element) {\n  element.classList.remove('is-hidden');\n}\n\nexport function hideEndMessage(element) {\n  element.classList.add('is-hidden');\n}\n\nexport function smoothScrollToNextImages() {\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { fetchImages } from './js/pixabay-api.js';\nimport {\n  renderGallery,\n  clearGallery,\n  showElement,\n  hideElement,\n  showLoadingIndicator,\n  hideLoadingIndicator,\n  showEndMessage,\n  hideEndMessage,\n  smoothScrollToNextImages,\n} from './js/render-functions.js';\n\nconst searchForm = document.querySelector('#search-form');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.load-more');\nconst loadingIndicator = document.querySelector('.loading-indicator');\nconst endMessage = document.querySelector('.end-message');\n\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nlet currentSearchQuery = '';\nlet currentPage = 1;\nlet totalHits = 0;\n\nhideElement(loadMoreBtn);\nhideElement(loadingIndicator);\nhideElement(endMessage);\n\nsearchForm.addEventListener('submit', onSearchFormSubmit);\nloadMoreBtn.addEventListener('click', onLoadMoreClick);\n\nasync function onSearchFormSubmit(event) {\n  event.preventDefault();\n\n  const searchQuery = event.currentTarget.elements.searchQuery.value.trim();\n\n  if (!searchQuery) {\n    alert('Please enter a search query');\n    return;\n  }\n\n  if (searchQuery === currentSearchQuery) {\n    alert('You are already viewing results for this query');\n    return;\n  }\n\n  currentSearchQuery = searchQuery;\n  currentPage = 1;\n  clearGallery(gallery);\n  hideElement(loadMoreBtn);\n  hideElement(endMessage);\n\n  await fetchAndRenderImages();\n}\n\nasync function onLoadMoreClick() {\n  currentPage += 1;\n  await fetchAndRenderImages(false);\n}\n\nasync function fetchAndRenderImages(isNewSearch = true) {\n  try {\n    showLoadingIndicator(loadingIndicator);\n    hideElement(loadMoreBtn);\n\n    const data = await fetchImages(currentSearchQuery, currentPage);\n    totalHits = data.totalHits;\n\n    if (data.hits.length === 0) {\n      alert(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n      return;\n    }\n\n    renderGallery(data.hits, gallery);\n    lightbox.refresh();\n\n    if (isNewSearch && data.totalHits > 0) {\n      alert(`Hooray! We found ${data.totalHits} images.`);\n    }\n\n    const totalPages = Math.ceil(data.totalHits / 15);\n    if (currentPage >= totalPages) {\n      hideElement(loadMoreBtn);\n      showEndMessage(endMessage);\n    } else {\n      showElement(loadMoreBtn);\n      hideEndMessage(endMessage);\n    }\n\n    if (!isNewSearch) {\n      smoothScrollToNextImages();\n    }\n  } catch (error) {\n    alert(`Error: ${error.message}`);\n  } finally {\n    hideLoadingIndicator(loadingIndicator);\n  }\n}\n"],"names":["API_KEY","BASE_URL","fetchImages","searchQuery","page","perPage","axios","error","renderGallery","images","galleryElement","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showElement","element","hideElement","showLoadingIndicator","hideLoadingIndicator","showEndMessage","hideEndMessage","smoothScrollToNextImages","cardHeight","searchForm","gallery","loadMoreBtn","loadingIndicator","endMessage","lightbox","SimpleLightbox","currentSearchQuery","currentPage","totalHits","onSearchFormSubmit","onLoadMoreClick","event","fetchAndRenderImages","isNewSearch","data","totalPages"],"mappings":"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"}